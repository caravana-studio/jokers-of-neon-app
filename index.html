<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Dojo React Vite</title>
        <script>
            window.addEventListener("load", function () {
              var main = document.querySelector("main");
              var canvas = document.getElementById("canvas");
              var ctx = canvas.getContext("2d");
              var av1 = document.querySelector(".av1");
              var strk = document.querySelector(".strk");
              var press = document.querySelector(".press");
              var ww = window.innerWidth;
              var menu = document.querySelector(".menu");
              var ul = menu?.querySelector("ul");
              var idx = 0;
              var count = ul?.childElementCount - 1;
              var toggle = true;
              var frame;
      
              // Set canvas size
              canvas.width = ww / 3;
              canvas.height = (ww * 0.5625) / 3;
      
              // Generate CRT noise
              function snow(ctx) {
                var w = ctx.canvas.width,
                  h = ctx.canvas.height,
                  d = ctx.createImageData(w, h),
                  b = new Uint32Array(d.data.buffer),
                  len = b.length;
      
                for (var i = 0; i < len; i++) {
                  b[i] = ((255 * Math.random()) | 0) << 24;
                }
      
                ctx.putImageData(d, 0, 0);
              }
      
              function animate() {
                snow(ctx);
                frame = requestAnimationFrame(animate);
              }
      
              // Glitch
              for (i = 0; i < 4; i++) {
                if (av1) {
                  var av1Span = av1.firstElementChild.cloneNode(true);
                  av1.appendChild(av1Span);
                }
                if (strk) {
                  var strkSpan = strk.firstElementChild.cloneNode(true);
                  strk.appendChild(strkSpan);
                }
                if (press) {
                  var pressSpan = press.firstElementChild.cloneNode(true);
                  press.appendChild(pressSpan);
                }
              }
      
              /*         window.addEventListener("DOMContentLoaded", function (e) {
              }); */
              setTimeout(function () {
                main.classList.add("on");
                main.classList.remove("off");
                animate();
              }, 1000);
      
              window.addEventListener(
                "keydown",
                function (e) {
                  var key = e.keyCode;
                  var prev = idx;
                  if (key == 38 || key == 40) {
                    e.preventDefault();
      
                    switch (key) {
                      case 38:
                        if (idx > 0) {
                          idx--;
                        }
                        break;
                      case 40:
                        if (idx < count) {
                          idx++;
                        }
                        break;
                    }
      
                    ul?.children[prev].classList.remove("active");
                    ul?.children[idx].classList.add("active");
                  }
                },
                false
              );
            });
          </script>
    </head>
    <body>
        <div id="root"></div>
        <script type="module" src="/src/main.tsx"></script>
    </body>
</html>
